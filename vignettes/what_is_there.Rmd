---
title: "What is in the package?"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{what_is_there}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  chunk_output_type: console
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Example files

This package provides example files containing artificial path data. The files 
are located in the `extdata` folder of the package. The private function
`extdata_file()` returns the full path to a file in this folder when being given 
the filename:

```{r}
example_file <- kwb.fakin::extdata_file("example_file_info_1.csv")
```

## Read Functions

The package contains functions named `read_*`. These functions are 
described in the following.

### read_csv()

This function reads a csv file either with `read.table()` (version = 1) or 
with `data.table::fread()` (version = 2). It reports about what it does and 
about the time it takes.

```{r}
data_1 <- kwb.fakin::read_csv(example_file, version = 1) 

data_2 <- kwb.fakin::read_csv(example_file, version = 2)

head(data_1, 3)

head(data_2, 3)

identical(data_1, data_2)
```

### read_file_info()

This function reads a text file that contains file information, such as file 
path, file size, creation time or last modification time. The file is read with
`read_csv()`, see above. File sizes are assumed to be given in bytes and are
converted to Mebibytes (MiB = 2^20 bytes) in order to avoid very large numbers
that require a non-standard data type.

```{r}
file_info <- kwb.fakin::read_file_info(example_file)

head(file_info)
```

### read_path_information()

This function reads file information files from a folder by giving a pattern
matching the names of the files to be read. It calls `read_file_info()` in a 
loop over the files and returns a list with the list elements named according
to the file names. List elements read from files matching the name pattern
`path-info_<yyyy-mm-dd_HHMM>_<name>.csv` are simply named `<name>`.

```{r error = TRUE}
file_infos <- kwb.fakin::read_path_information(
  file_info_dir = kwb.fakin:::extdata_file(""), 
  pattern = "^example.*\\.csv$", 
  sep = ";"
)
```

### read_paths()

This function reads files that contain one file path per line. You can specify
the `fileEncoding` assumed for the file. When being set to `NULL` the function
uses `utils::localeToCharset()` to guess an encoding. The encoding is passed to
the function `file()` that is used to open an explicit connection. This 
connection is then given to `readLines()`. The lines read are assumed to be
full file paths. It is checked for backslashes that are converted to slashes.
Finally, by default, all paths are sorted. 

```{r}
#kwb.fakin::read_paths(kwb.fakin:::extdata_file("paths"))
```

## File Listing Functions

The functions treated so far have in common that they read file information from
files. The following functions can be used to create these files. They use `dir`
or more advanced functions from the fs package.

### list_files

```{r}
kwb.fakin::list_files
```

### get_recursive_file_info

```{r}
kwb.fakin::get_recursive_file_info
```

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Working with Paths • kwb.fakin</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Working with Paths">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">kwb.fakin</a>
        <span class="label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development package">0.2.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/analyse_scripts.html">Analysing R Scripts</a>
    </li>
    <li>
      <a href="../articles/understanding_encoding.html">Understanding Encoding</a>
    </li>
    <li>
      <a href="../articles/working_with_paths.html">Working with Paths</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kwb-r/kwb.fakin">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="working_with_paths_files/htmlwidgets-1.0/htmlwidgets.js"></script><script src="working_with_paths_files/d3-4.5.0/d3.min.js"></script><script src="working_with_paths_files/sankey-1/sankey.js"></script><script src="working_with_paths_files/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Working with Paths</h1>
                        <h4 class="author">Hauke Sonnenberg</h4>
            
            <h4 class="date">2018-07-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kwb-r/kwb.fakin/blob/master/vignettes/working_with_paths.Rmd"><code>vignettes/working_with_paths.Rmd</code></a></small>
      <div class="hidden name"><code>working_with_paths.Rmd</code></div>

    </div>

    
    
<p>In our FAKIN project we want to improve the (research) data management at KWB. We realised that we have difficulties in finding files. One reason is that our folder structures differ between the projects and they are often not intuitive at all.</p>
<p>This package contains functions that help analysing folder structures.</p>
<div id="providing-file-path-information" class="section level2">
<h2 class="hasAnchor">
<a href="#providing-file-path-information" class="anchor"></a>Providing File Path Information</h2>
<p>Assume we have a vector of file paths. It may have been read from a file that was created by redirecting the output of the <code>dir</code> command in the Windows Command Window to a file (<code>dir /s /b &gt; paths.txt</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">paths &lt;-<span class="st"> </span><span class="kw">c</span>(
  <span class="st">"project_1/wp_1/input/file_1.csv"</span>,
  <span class="st">"project_1/wp_1/input/file_2.csv"</span>,
  <span class="st">"project_1/wp_1/analysis/summary.pdf"</span>,
  <span class="st">"project_1/wp_2/input/köpenick_dirty.csv"</span>,
  <span class="st">"project_1/wp_2/output/koepenick_clean.csv"</span>,
  <span class="st">"project_2/Daten/file_1.csv"</span>,
  <span class="st">"project_2/Grafiken/file_1.png"</span>,
  <span class="st">"project_2/Berichte/bericht_1.doc"</span>,
  <span class="st">"project_2/Berichte/bericht_2.doc"</span>
)</code></pre></div>
</div>
<div id="plotting-paths" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-paths" class="anchor"></a>Plotting Paths</h2>
<p>Let’s get a first impression on the paths defined above by plotting them. We provide a plot function that uses the <code><a href="http://www.rdocumentation.org/packages/networkD3/topics/sankeyNetwork">sankeyNetwork()</a></code> function from the networkD3 package. Make sure that this package is installed:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="st"> </span><span class="kw">require</span>(<span class="st">"networkD3"</span>)) {
  
  <span class="kw">install.packages</span>(<span class="st">"networkD3"</span>, <span class="dt">repos =</span> <span class="st">"https://cloud.r-project.org"</span>)
}</code></pre></div>
<pre><code>## Lade nötiges Paket: networkD3</code></pre>
<p>You can then use the <code><a href="../reference/plot_path_network.html">plot_path_network()</a></code> function from the kwb.fakin package to plot the example paths defined above:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kwb.fakin<span class="op">::</span><span class="kw">plot_path_network</span>(paths)</code></pre></div>
<div id="htmlwidget-83e6cadb1fe60df183f8" style="width:700px;height:432.632880098888px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-83e6cadb1fe60df183f8">{"x":{"links":{"source":[2,3,4,5,6],"target":[0,0,0,1,1],"value":[2,1,1,3,2]},"nodes":{"name":["project_2","project_1","Berichte","Daten","Grafiken","wp_1","wp_2"],"group":["project_2","project_1","Berichte","Daten","Grafiken","wp_1","wp_2"]},"options":{"NodeID":"name","NodeGroup":"name","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":7,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script><p>The function accepts all arguments provided by <code><a href="http://www.rdocumentation.org/packages/networkD3/topics/sankeyNetwork">networkD3::sankeyNetwork()</a></code>. You may e.g. use the argument <code>fontSize</code> to increase the node labels:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kwb.fakin<span class="op">::</span><span class="kw">plot_path_network</span>(paths, <span class="dt">fontSize =</span> <span class="dv">16</span>)</code></pre></div>
<div id="htmlwidget-b5b8c657c497b58848c3" style="width:700px;height:432.632880098888px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-b5b8c657c497b58848c3">{"x":{"links":{"source":[2,3,4,5,6],"target":[0,0,0,1,1],"value":[2,1,1,3,2]},"nodes":{"name":["project_2","project_1","Berichte","Daten","Grafiken","wp_1","wp_2"],"group":["project_2","project_1","Berichte","Daten","Grafiken","wp_1","wp_2"]},"options":{"NodeID":"name","NodeGroup":"name","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":16,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script><p>By default only the first two levels of folders or files are shown. You can increase the folder level by setting the <code>max_depth</code> argument:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kwb.fakin<span class="op">::</span><span class="kw">plot_path_network</span>(paths, <span class="dt">max_depth =</span> <span class="dv">4</span>, <span class="dt">fontSize =</span> <span class="dv">16</span>)</code></pre></div>
<div id="htmlwidget-08c2008837e62a4ccf96" style="width:700px;height:432.632880098888px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-08c2008837e62a4ccf96">{"x":{"links":{"source":[3,4,5,2,6,10,11,12,13,14,7,9,8,15,16,17,18,19],"target":[0,0,0,1,1,2,3,3,4,5,2,6,6,7,7,8,9,10],"value":[2,1,1,3,2,1,1,1,1,1,2,1,1,1,1,1,1,1]},"nodes":{"name":["project_2","project_1","wp_1","Berichte","Daten","Grafiken","wp_2","input","output","input","analysis","bericht_1.doc","bericht_2.doc","file_1.csv","file_1.png","file_1.csv","file_2.csv","koepenick_clean.csv","köpenick_dirty.csv","summary.pdf"],"group":["project_2","project_1","wp_1","Berichte","Daten","Grafiken","wp_2","input","output","input","analysis","bericht_1.doc","bericht_2.doc","file_1.csv","file_1.png","file_1.csv","file_2.csv","koepenick_clean.csv","köpenick_dirty.csv","summary.pdf"]},"options":{"NodeID":"name","NodeGroup":"name","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":16,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="quality-of-file-and-folder-names" class="section level2">
<h2 class="hasAnchor">
<a href="#quality-of-file-and-folder-names" class="anchor"></a>Quality of File and Folder Names</h2>
<p>The automatic processing of files may fail due to special characters (e.g. German Umlaute) that are contained in the folder or file names. The package contains a function <code>ascii_stats</code> that calculates the percentages of strings containing or not containing special (non-ASCII) characters.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kwb.fakin<span class="op">:::</span><span class="kw">ascii_stats</span>(paths)</code></pre></div>
<pre><code>## nonAscii
##    FALSE     TRUE 
## 88.88889 11.11111</code></pre>
<p>The aim should be to reduce the percentage of non-ASCI characters.</p>
</div>
<div id="quality-of-folder-structures" class="section level2">
<h2 class="hasAnchor">
<a href="#quality-of-folder-structures" class="anchor"></a>Quality of Folder Structures</h2>
<p>If we modify folder structures in order to make them more intuitive we need a tool to measure the improvement. Therefore I created an account on the following website:</p>
<p><a href="https://www.optimalworkshop.com/treejack" class="uri">https://www.optimalworkshop.com/treejack</a></p>
<p>There, you can define tree structures of which interactive web-pages are created where users are asked to navigate to a certain file in the tree. Behind the scenes the web page tracks the clicks of the user on his way through the tree. The treejack service provides an import functionality where you can define the structure of the tree by giving a set of text lines with each line representing a branch or a leaf of the tree.</p>
<p>The function <code>subtree_for_treejack</code> creates the text that is required here:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kwb.fakin<span class="op">:::</span><span class="kw">subtree_for_treejack</span>(<span class="dt">root =</span> <span class="st">"project_1"</span>, paths)</code></pre></div>
<pre><code>## Filter for paths starting with project_1/ ...
##   ok. Remaining paths: 5 
## Convert to relative paths ... ok.
## Splitting paths... ok.
## 
## ================================================================
## 
## Copy and paste the output below to the 'Bulk import' input field
## at https://www.optimalworkshop.com
## 
## ================================================================
## 
## wp_1 
##  analysis
##  input
## wp_2 
##  input
##  output</code></pre>
</div>
<div id="analysis-of-paths" class="section level2">
<h2 class="hasAnchor">
<a href="#analysis-of-paths" class="anchor"></a>Analysis of Paths</h2>
<p>We can split the paths into their parts using <code>splitPaths</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">parts &lt;-<span class="st"> </span>kwb.fakin<span class="op">:::</span><span class="kw">splitPaths</span>(paths)</code></pre></div>
<pre><code>## Splitting paths... ok.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">parts[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</code></pre></div>
<pre><code>## [[1]]
## [1] "project_1"  "wp_1"       "input"      "file_1.csv"
## 
## [[2]]
## [1] "project_1"  "wp_1"       "input"      "file_2.csv"
## 
## [[3]]
## [1] "project_1"   "wp_1"        "analysis"    "summary.pdf"</code></pre>
<p>It may be useful to convert the list that is returned by <code>splitPaths</code> into a matrix:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">subdirs &lt;-<span class="st"> </span>kwb.fakin<span class="op">:::</span><span class="kw">toSubdirMatrix</span>(parts)</code></pre></div>
<table class="table">
<caption>Content of the subdirs matrix</caption>
<tbody>
<tr class="odd">
<td align="left">project_1</td>
<td align="left">wp_1</td>
<td align="left">input</td>
<td align="left">file_1.csv</td>
</tr>
<tr class="even">
<td align="left">project_1</td>
<td align="left">wp_1</td>
<td align="left">input</td>
<td align="left">file_2.csv</td>
</tr>
<tr class="odd">
<td align="left">project_1</td>
<td align="left">wp_1</td>
<td align="left">analysis</td>
<td align="left">summary.pdf</td>
</tr>
<tr class="even">
<td align="left">project_1</td>
<td align="left">wp_2</td>
<td align="left">input</td>
<td align="left">köpenick_dirty.csv</td>
</tr>
<tr class="odd">
<td align="left">project_1</td>
<td align="left">wp_2</td>
<td align="left">output</td>
<td align="left">koepenick_clean.csv</td>
</tr>
<tr class="even">
<td align="left">project_2</td>
<td align="left">Daten</td>
<td align="left">file_1.csv</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">project_2</td>
<td align="left">Grafiken</td>
<td align="left">file_1.png</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">project_2</td>
<td align="left">Berichte</td>
<td align="left">bericht_1.doc</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">project_2</td>
<td align="left">Berichte</td>
<td align="left">bericht_2.doc</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>In the matrix, each row represents a path and each column represents a depth level.</p>
<p>If you have only one path, you may create the paths to all direct parent directories using the function <code>all_path_levels</code>. This is how <code>subtree_for_treejack</code> creates the text for the bulk import to Treejack (see above).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(parent_paths &lt;-<span class="st"> </span>kwb.fakin<span class="op">:::</span><span class="kw"><a href="../reference/all_path_levels.html">all_path_levels</a></span>(paths[<span class="dv">1</span>]))</code></pre></div>
<pre><code>## [1] "project_1"                       "project_1/wp_1"                 
## [3] "project_1/wp_1/input"            "project_1/wp_1/input/file_1.csv"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">parents &lt;-<span class="st"> </span>kwb.fakin<span class="op">:::</span><span class="kw">toSubdirMatrix</span>(kwb.fakin<span class="op">:::</span><span class="kw">splitPaths</span>(parent_paths))</code></pre></div>
<pre><code>## Splitting paths... ok.</code></pre>
<table class="table">
<caption>Content of the parents matrix</caption>
<tbody>
<tr class="odd">
<td align="left">project_1</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td align="left">project_1</td>
<td>wp_1</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td align="left">project_1</td>
<td>wp_1</td>
<td>input</td>
<td></td>
</tr>
<tr class="even">
<td align="left">project_1</td>
<td>wp_1</td>
<td>input</td>
<td>file_1.csv</td>
</tr>
</tbody>
</table>
</div>
<div id="importance-of-directories" class="section level2">
<h2 class="hasAnchor">
<a href="#importance-of-directories" class="anchor"></a>Importance of Directories</h2>
<p>In order to find the most important folder paths in terms of frequency and length you may use the function <code>sortedImportance</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kwb.fakin<span class="op">:::</span><span class="kw"><a href="../reference/sortedImportance.html">sortedImportance</a></span>(<span class="kw">dirname</span>(paths))</code></pre></div>
<pre><code>## x
##    project_1/wp_1/input      project_2/Berichte project_1/wp_1/analysis 
##                      40                      36                      23 
##   project_1/wp_2/output    project_1/wp_2/input      project_2/Grafiken 
##                      21                      20                      18 
##         project_2/Daten 
##                      15</code></pre>
</div>
<div id="compression-of-folder-paths" class="section level2">
<h2 class="hasAnchor">
<a href="#compression-of-folder-paths" class="anchor"></a>Compression of Folder Paths</h2>
<p>Assume you have a folder with a long path (either due to a lot of levels or due to long folder names). This long path is repeated for each file in the folder. The package provides a <code>compress</code> function that may be used to introduce short names for directory paths.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">directories &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"short"</span>, <span class="st">"short"</span>, <span class="st">"short"</span>, <span class="st">"longer/path"</span>, <span class="st">"longer/path"</span>)

short_dirs &lt;-<span class="st"> </span>kwb.fakin<span class="op">:::</span><span class="kw">compress</span>(directories)

<span class="kw">as.character</span>(short_dirs)</code></pre></div>
<pre><code>## [1] "&lt;a2&gt;" "&lt;a2&gt;" "&lt;a2&gt;" "&lt;a1&gt;" "&lt;a1&gt;"</code></pre>
<p>The function returns the lookup table (dictionary) that maps short names to long names in the attribute <code>dict</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(dictionary &lt;-<span class="st"> </span>kwb.utils<span class="op">::</span><span class="kw">getAttribute</span>(short_dirs, <span class="st">"dict"</span>))
## $a1
## [1] "longer/path"
## 
## $a2
## [1] "short"</code></pre></div>
<p>The dictionary is sorted by the importance of the strings (paths) that have been given to <code>compress</code> so that the most important paths get the highest positions in the dictionary. With importance we mean the product of the length of a string (path) and its number of occurrences.</p>
<p>The dictionary is required to convert the short names back to the original paths using the <code>resolve</code> function of the <code>kwb.utils</code> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(long_dirs &lt;-<span class="st"> </span>kwb.utils<span class="op">::</span><span class="kw">resolve</span>(short_dirs, dictionary))
## [1] "short"       "short"       "short"       "longer/path" "longer/path"

<span class="kw">identical</span>(long_dirs, directories)
## [1] TRUE</code></pre></div>
<p>There is another function <code>compressOneByOne</code>, what does it do?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(kwb.fakin<span class="op">:::</span><span class="kw">compressOneByOne</span>(paths, <span class="dt">n =</span> <span class="dv">3</span>))</code></pre></div>
<pre><code>## Splitting paths... ok.
## Elapsed: 0.0 s
## Splitting paths... ok.
## Elapsed: 0.0 s
## Splitting paths... ok.
## Elapsed: 0.0 s</code></pre>
<pre><code>## NULL</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#providing-file-path-information">Providing File Path Information</a></li>
      <li><a href="#plotting-paths">Plotting Paths</a></li>
      <li><a href="#quality-of-file-and-folder-names">Quality of File and Folder Names</a></li>
      <li><a href="#quality-of-folder-structures">Quality of Folder Structures</a></li>
      <li><a href="#analysis-of-paths">Analysis of Paths</a></li>
      <li><a href="#importance-of-directories">Importance of Directories</a></li>
      <li><a href="#compression-of-folder-paths">Compression of Folder Paths</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Hauke Sonnenberg.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>

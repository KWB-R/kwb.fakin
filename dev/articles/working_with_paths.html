<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Working with Paths • kwb.fakin</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Working with Paths">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">kwb.fakin</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.3.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/analyse_scripts.html">Analysing R Scripts</a>
    </li>
    <li>
      <a href="../articles/track_folder_changes.html">Tracking Changes in Folder Structures</a>
    </li>
    <li>
      <a href="../articles/understanding_encoding.html">Understanding Encoding</a>
    </li>
    <li>
      <a href="../articles/working_with_paths.html">Working with Paths</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kwb-r/kwb.fakin">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="working_with_paths_files/htmlwidgets-1.3/htmlwidgets.js"></script><script src="working_with_paths_files/d3-4.5.0/d3.min.js"></script><script src="working_with_paths_files/sankey-1/sankey.js"></script><script src="working_with_paths_files/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Working with Paths</h1>
                        <h4 class="author">Hauke Sonnenberg</h4>
            
            <h4 class="date">2019-03-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kwb-r/kwb.fakin/blob/master/vignettes/working_with_paths.Rmd"><code>vignettes/working_with_paths.Rmd</code></a></small>
      <div class="hidden name"><code>working_with_paths.Rmd</code></div>

    </div>

    
    
<p>In our FAKIN project we want to improve the (research) data management at KWB. We realised that we have difficulties in finding files. One reason is that our folder structures differ between the projects and they are often not intuitive at all.</p>
<p>This package contains functions that help analysing folder structures.</p>
<div id="providing-file-path-information" class="section level2">
<h2 class="hasAnchor">
<a href="#providing-file-path-information" class="anchor"></a>Providing File Path Information</h2>
<p>Assume we have a vector of file paths. It may have been read from a file that was created by redirecting the output of the <code>dir</code> command in the Windows Command Window to a file (<code>dir /s /b &gt; paths.txt</code>).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">paths &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">  <span class="st">"project-1/wp-1/input/file 1.csv"</span>,</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">  <span class="st">"project-1/wp-1/input/file-2.csv"</span>,</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">  <span class="st">"project-1/wp-1/analysis/summary.pdf"</span>,</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">  <span class="st">"project-1/wp 2/input/köpenick_dirty.csv"</span>,</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">  <span class="st">"project-1/wp 2/output/koepenick_clean.csv"</span>,</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">  <span class="st">"project-2/Daten/file-1.csv"</span>,</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">  <span class="st">"project-2/Grafiken/file 1.png"</span>,</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">  <span class="st">"project-2/Berichte/bericht-1.doc"</span>,</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">  <span class="st">"project-2/Berichte/bericht-2.doc"</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11">)</a></code></pre></div>
</div>
<div id="plotting-paths" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-paths" class="anchor"></a>Plotting Paths</h2>
<p>Let’s get a first impression on the paths defined above by plotting them. We provide a plot function that uses the <code><a href="https://www.rdocumentation.org/packages/networkD3/topics/sankeyNetwork">sankeyNetwork()</a></code> function from the networkD3 package. Make sure that this package is installed:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="cf">if</span> (<span class="op">!</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">require</a></span>(<span class="st">"networkD3"</span>)) {</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  <span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"networkD3"</span>, <span class="dt">repos =</span> <span class="st">"https://cloud.r-project.org"</span>)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">}</a></code></pre></div>
<pre><code>## Loading required package: networkD3</code></pre>
<p>You can then use the <code><a href="../reference/plot_path_network.html">plot_path_network()</a></code> function from the kwb.fakin package to plot the example paths defined above:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">kwb.fakin<span class="op">::</span><span class="kw">plot_path_network</span>(paths)</a></code></pre></div>
<pre><code>## Splitting paths ... ok. (0.00s) 
## Putting path segments together ... ok. (0.00s) 
## Splitting paths ... ok. (0.00s)</code></pre>
<div id="htmlwidget-4882d1639420f92eb57a" style="width:700px;height:162px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-4882d1639420f92eb57a">{"x":{"links":{"source":[0,0,0,1,1,2,3,3,4,5,6,2,6],"target":[3,5,4,6,2,7,8,9,10,11,12,13,14],"value":[2,1,1,2,3,1,1,1,1,1,1,2,1]},"nodes":{"name":["project-2","project-1","wp-1","Berichte","Grafiken","Daten","wp 2","analysis","bericht-1.doc","bericht-2.doc","file 1.png","file-1.csv","input","input","output"],"group":["green","green","green","green","green","green","yellow","green","green","green","yellow","green","green","green","green"]},"options":{"NodeID":"name","NodeGroup":"colour","LinkGroup":null,"colourScale":"d3.scaleOrdinal() .domain(['green', 'yellow']) .range(['green', 'yellow'])","fontSize":7,"fontFamily":null,"nodeWidth":15,"nodePadding":8,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":false}},"evals":[],"jsHooks":[]}</script><p>The function accepts all arguments provided by <code><a href="https://www.rdocumentation.org/packages/networkD3/topics/sankeyNetwork">networkD3::sankeyNetwork()</a></code>. You may e.g. use the argument <code>fontSize</code> to increase the node labels:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">kwb.fakin<span class="op">::</span><span class="kw">plot_path_network</span>(paths, <span class="dt">fontSize =</span> <span class="dv">16</span>)</a></code></pre></div>
<pre><code>## Splitting paths ... ok. (0.00s) 
## Putting path segments together ... ok. (0.00s) 
## Splitting paths ... ok. (0.00s)</code></pre>
<div id="htmlwidget-e321de6a2308f949c4b4" style="width:700px;height:162px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-e321de6a2308f949c4b4">{"x":{"links":{"source":[0,0,0,1,1,2,3,3,4,5,6,2,6],"target":[3,5,4,6,2,7,8,9,10,11,12,13,14],"value":[2,1,1,2,3,1,1,1,1,1,1,2,1]},"nodes":{"name":["project-2","project-1","wp-1","Berichte","Grafiken","Daten","wp 2","analysis","bericht-1.doc","bericht-2.doc","file 1.png","file-1.csv","input","input","output"],"group":["green","green","green","green","green","green","yellow","green","green","green","yellow","green","green","green","green"]},"options":{"NodeID":"name","NodeGroup":"colour","LinkGroup":null,"colourScale":"d3.scaleOrdinal() .domain(['green', 'yellow']) .range(['green', 'yellow'])","fontSize":16,"fontFamily":null,"nodeWidth":15,"nodePadding":8,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":false}},"evals":[],"jsHooks":[]}</script><p>Let’s always use this font size by defining a short helper function:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">plot_16pt &lt;-<span class="st"> </span><span class="cf">function</span>(...) kwb.fakin<span class="op">::</span><span class="kw">plot_path_network</span>(..., <span class="dt">fontSize =</span> <span class="dv">16</span>)</a></code></pre></div>
<p>By default only the first three levels of folders or files are shown. You can increase (or decrease) the number of shown levels by setting the <code>max_depth</code> argument:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">plot_16pt</span>(paths, <span class="dt">max_depth =</span> <span class="dv">4</span>)</a></code></pre></div>
<pre><code>## Splitting paths ... ok. (0.00s) 
## Putting path segments together ... ok. (0.00s) 
## Splitting paths ... ok. (0.00s)</code></pre>
<div id="htmlwidget-d61ebee2fba7c68bb241" style="width:700px;height:162px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-d61ebee2fba7c68bb241">{"x":{"links":{"source":[0,0,0,1,1,2,3,3,4,5,6,2,6,7,7,8,9,10],"target":[3,5,4,6,2,10,11,12,13,14,9,7,8,15,16,17,18,19],"value":[2,1,1,2,3,1,1,1,1,1,1,2,1,1,1,1,1,1]},"nodes":{"name":["project-2","project-1","wp-1","Berichte","Grafiken","Daten","wp 2","input","output","input","analysis","bericht-1.doc","bericht-2.doc","file 1.png","file-1.csv","file 1.csv","file-2.csv","koepenick_clean.csv","köpenick_dirty.csv","summary.pdf"],"group":["green","green","green","green","green","green","yellow","green","green","green","green","green","green","yellow","green","yellow","green","green","red","green"]},"options":{"NodeID":"name","NodeGroup":"colour","LinkGroup":null,"colourScale":"d3.scaleOrdinal() .domain(['green', 'yellow', 'red']) .range(['green', 'yellow', 'red'])","fontSize":16,"fontFamily":null,"nodeWidth":15,"nodePadding":8,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":false}},"evals":[],"jsHooks":[]}</script><p>Now, that all three traffic light colours (green, yellow, red) appear in the plot, we want to explain what these colours are intended to indicate:</p>
<ul>
<li><p>Green: name is fully compliant with our naming rules. It consists only of alphanumeric letters, underscore, hyphen or dot.</p></li>
<li><p>Yellow: name is almost compliant with our naming rules. It constists only of alphanumeric letters, underscore, hyphen, dot or space.</p></li>
<li><p>Red: name does not comply with our naming rules. It contains at least one character that is not alphanumeric or underscore, hyphen, dot or space. In most of our cases this is due to German special characters, such as ‘ä’, ‘ö’, ‘ü’.</p></li>
</ul>
<p>The naming rules are documented in our <a href="https://kwb-r.github.io/fakin.doc/best-practices.html#data-storage-naming">FAKIN Best Practices Document</a></p>
</div>
<div id="treemaps" class="section level2">
<h2 class="hasAnchor">
<a href="#treemaps" class="anchor"></a>Treemaps</h2>
<p>The proportion of folder sizes can be visualised in so called tree-maps. We provide a function that uses the <code>treemaps</code> package to generate these plots.</p>
<p>The input to the function is a data frame with columns <code>path</code>, <code>type</code> and <code>size</code>, representing the file or folder paths, the type of path (<code>"file"</code> or <code>"directory"</code>) and file size, respectively. Such a data frame can e.g. be retrieved by means of the function <code><a href="../reference/get_recursive_file_info.html">get_recursive_file_info()</a></code>. Here, we provide some fake data:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">file_info &lt;-<span class="st"> </span>kwb.utils<span class="op">::</span><span class="kw">noFactorDataFrame</span>(</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">  <span class="dt">path =</span> paths,</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">  <span class="dt">type =</span> <span class="st">"file"</span>,</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">  <span class="dt">size =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(paths), <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">) </a></code></pre></div>
<p>From these file information, generate the treeplot with <code><a href="../reference/plot_treemaps_from_path_data.html">plot_treemaps_from_path_data()</a></code>. Two plots are generated:</p>
<ul>
<li><p>In the first plot, the rectangle sizes represent the total size of files that are contained in the corresponding folder and all of its subfolders. The colour indicates the total number of files that are contained in the folders.</p></li>
<li><p>In the second plot, the rectangle sizes represent the total number of files that are contained in the corresponding folder and all of its subfolders. The colour indicates the total size of files that are contained in the folders.</p></li>
</ul>
<pre><code>## Preparing data for 'root' ... 
## Splitting paths ... ok. (0.00s) 
## ok. (0.00s) 
## Aggregating by first 3 path levels ... ok. (0.18s) 
## Creating treemap 'size' ...</code></pre>
<p><img src="working_with_paths_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<pre><code>## ok. (0.57s) 
## Creating treemap 'files' ...</code></pre>
<p><img src="working_with_paths_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
<pre><code>## ok. (0.19s)</code></pre>
<pre><code>## NULL</code></pre>
<p>By default the plots are saved to png files in the temporary directory. To let the plots show up here we set <code>as_png</code> to <code>FALSE</code> in the above call.</p>
</div>
<div id="selecting-paths" class="section level2">
<h2 class="hasAnchor">
<a href="#selecting-paths" class="anchor"></a>Selecting Paths</h2>
<p>If you want to investigate a complex folder structure with hundreds or thousands of files the overview plot will not show up properly. It is then useful to select only a subsection of the folder structure for further investigation.</p>
<div id="selecting-paths-from-a-list-or-matrix-of-subfolders" class="section level3">
<h3 class="hasAnchor">
<a href="#selecting-paths-from-a-list-or-matrix-of-subfolders" class="anchor"></a>Selecting Paths from a List or Matrix of Subfolders</h3>
<p>Once you have split a vector of paths into its subfolder names you may use the function <code><a href="../reference/startsWithParts.html">startsWithParts()</a></code> to filter for paths starting with a certain sequence of subfolders:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">path_parts &lt;-<span class="st"> </span>kwb.file<span class="op">::</span><span class="kw">split_paths</span>(paths)</a></code></pre></div>
<pre><code>## Splitting paths ... ok. (0.00s)</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">start_parts &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"project-1"</span>, <span class="st">"wp-1"</span>)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"></a>
<a class="sourceLine" id="cb18-3" data-line-number="3">path_parts[kwb.fakin<span class="op">::</span><span class="kw">startsWithParts</span>(path_parts, start_parts)]</a></code></pre></div>
<pre><code>## [[1]]
## [1] "project-1"  "wp-1"       "input"      "file 1.csv"
## 
## [[2]]
## [1] "project-1"  "wp-1"       "input"      "file-2.csv"
## 
## [[3]]
## [1] "project-1"   "wp-1"        "analysis"    "summary.pdf"</code></pre>
<p>The function can also be used on a matrix of subfolders:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">folders &lt;-<span class="st"> </span>kwb.fakin<span class="op">::</span><span class="kw">toSubdirMatrix</span>(paths)</a></code></pre></div>
<pre><code>## Splitting paths ... ok. (0.00s)</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">folders[kwb.fakin<span class="op">::</span><span class="kw">startsWithParts</span>(folders, start_parts), ]</a></code></pre></div>
<pre><code>##      [,1]        [,2]   [,3]       [,4]         
## [1,] "project-1" "wp-1" "input"    "file 1.csv" 
## [2,] "project-1" "wp-1" "input"    "file-2.csv" 
## [3,] "project-1" "wp-1" "analysis" "summary.pdf"</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">folders[kwb.fakin<span class="op">::</span><span class="kw">startsWithParts</span>(folders, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(start_parts, <span class="st">"input"</span>)), ]</a></code></pre></div>
<pre><code>##      [,1]        [,2]   [,3]    [,4]        
## [1,] "project-1" "wp-1" "input" "file 1.csv"
## [2,] "project-1" "wp-1" "input" "file-2.csv"</code></pre>
</div>
<div id="selecting-paths-from-a-path-tree" class="section level3">
<h3 class="hasAnchor">
<a href="#selecting-paths-from-a-path-tree" class="anchor"></a>Selecting Paths from a Path Tree</h3>
<p>To simplify the selection of paths we wrote a function that converts a vector of path strings into a nested list. In that list, the folder names appear as the names of the list elements. Let’s try this out with the example paths defined above:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="co"># Convert the vector of paths into a tree structure</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2">path_tree &lt;-<span class="st"> </span>kwb.fakin<span class="op">:::</span><span class="kw"><a href="../reference/to_tree.html">to_tree</a></span>(paths)</a>
<a class="sourceLine" id="cb26-3" data-line-number="3"></a>
<a class="sourceLine" id="cb26-4" data-line-number="4"><span class="co"># Show the structure of the tree</span></a>
<a class="sourceLine" id="cb26-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(path_tree)</a></code></pre></div>
<pre><code>## List of 2
##  $ project-1:List of 2
##   ..$ wp 2:List of 2
##   .. ..$ input :List of 1
##   .. .. ..$ köpenick_dirty.csv: chr ""
##   .. .. ..- attr(*, "class")= chr [1:2] "path_tree" "list"
##   .. ..$ output:List of 1
##   .. .. ..$ koepenick_clean.csv: chr ""
##   .. .. ..- attr(*, "class")= chr [1:2] "path_tree" "list"
##   .. ..- attr(*, "class")= chr [1:2] "path_tree" "list"
##   ..$ wp-1:List of 2
##   .. ..$ analysis:List of 1
##   .. .. ..$ summary.pdf: chr ""
##   .. .. ..- attr(*, "class")= chr [1:2] "path_tree" "list"
##   .. ..$ input   :List of 2
##   .. .. ..$ file 1.csv: chr ""
##   .. .. ..$ file-2.csv: chr ""
##   .. .. ..- attr(*, "class")= chr [1:2] "path_tree" "list"
##   .. ..- attr(*, "class")= chr [1:2] "path_tree" "list"
##   ..- attr(*, "class")= chr [1:2] "path_tree" "list"
##  $ project-2:List of 3
##   ..$ Berichte:List of 2
##   .. ..$ bericht-1.doc: chr ""
##   .. ..$ bericht-2.doc: chr ""
##   .. ..- attr(*, "class")= chr [1:2] "path_tree" "list"
##   ..$ Daten   :List of 1
##   .. ..$ file-1.csv: chr ""
##   .. ..- attr(*, "class")= chr [1:2] "path_tree" "list"
##   ..$ Grafiken:List of 1
##   .. ..$ file 1.png: chr ""
##   .. ..- attr(*, "class")= chr [1:2] "path_tree" "list"
##   ..- attr(*, "class")= chr [1:2] "path_tree" "list"
##  - attr(*, "class")= chr [1:2] "path_tree" "list"</code></pre>
<p>The path tree is a list of lists with the top level elements representing the top level folders of the paths, the second level elements representing the sub-folders of the top level folders, and so on. With that tree structure, it is easy to select a sub-tree by just using the dollar operator <code>$</code> for lists. If, for example, we want to select the paths belonging to project 1, we can write:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="co"># Select the sub-tree below "project-1"</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2">subtree &lt;-<span class="st"> </span>path_tree<span class="op">$</span><span class="st">`</span><span class="dt">project-1</span><span class="st">`</span></a>
<a class="sourceLine" id="cb28-3" data-line-number="3"></a>
<a class="sourceLine" id="cb28-4" data-line-number="4"><span class="co"># Show the sub-tree</span></a>
<a class="sourceLine" id="cb28-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(subtree)</a></code></pre></div>
<pre><code>## List of 2
##  $ wp 2:List of 2
##   ..$ input :List of 1
##   .. ..$ köpenick_dirty.csv: chr ""
##   .. ..- attr(*, "class")= chr [1:2] "path_tree" "list"
##   ..$ output:List of 1
##   .. ..$ koepenick_clean.csv: chr ""
##   .. ..- attr(*, "class")= chr [1:2] "path_tree" "list"
##   ..- attr(*, "class")= chr [1:2] "path_tree" "list"
##  $ wp-1:List of 2
##   ..$ analysis:List of 1
##   .. ..$ summary.pdf: chr ""
##   .. ..- attr(*, "class")= chr [1:2] "path_tree" "list"
##   ..$ input   :List of 2
##   .. ..$ file 1.csv: chr ""
##   .. ..$ file-2.csv: chr ""
##   .. ..- attr(*, "class")= chr [1:2] "path_tree" "list"
##   ..- attr(*, "class")= chr [1:2] "path_tree" "list"
##  - attr(*, "class")= chr [1:2] "path_tree" "list"</code></pre>
<p><strong>Note</strong> that the element name <code>project-1</code> needs to be quoted in special quotes because, in R, the hyphen would else be interpreted as minus operator.</p>
<p>To convert the tree structure back to the path strings, use <code>flatten_tree</code>:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">kwb.fakin<span class="op">:::</span><span class="kw">flatten_tree</span>(subtree)</a></code></pre></div>
<pre><code>## [1] "wp 2/input/köpenick_dirty.csv"   "wp 2/output/koepenick_clean.csv"
## [3] "wp-1/analysis/summary.pdf"       "wp-1/input/file 1.csv"          
## [5] "wp-1/input/file-2.csv"</code></pre>
<p>You can plot the sub-tree by passing it directly to <code>plot_path_network</code>, or here to our helper function, without prior conversion:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">plot_16pt</span>(subtree)</a></code></pre></div>
<pre><code>## Splitting paths ... ok. (0.00s)</code></pre>
<div id="htmlwidget-cc8f8907850cca3f3de6" style="width:700px;height:90px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-cc8f8907850cca3f3de6">{"x":{"links":{"source":[0,1,0,1,2,2,3,4,5],"target":[5,4,2,3,6,7,8,9,10],"value":[1,1,2,1,1,1,1,1,1]},"nodes":{"name":["wp-1","wp 2","input","output","input","analysis","file 1.csv","file-2.csv","koepenick_clean.csv","köpenick_dirty.csv","summary.pdf"],"group":["green","yellow","green","green","green","green","yellow","green","green","red","green"]},"options":{"NodeID":"name","NodeGroup":"colour","LinkGroup":null,"colourScale":"d3.scaleOrdinal() .domain(['green', 'yellow', 'red']) .range(['green', 'yellow', 'red'])","fontSize":16,"fontFamily":null,"nodeWidth":15,"nodePadding":8,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="quality-of-file-and-folder-names" class="section level2">
<h2 class="hasAnchor">
<a href="#quality-of-file-and-folder-names" class="anchor"></a>Quality of File and Folder Names</h2>
<p>The automatic processing of files may fail due to special characters (e.g. German Umlaute) that are contained in the folder or file names. The package contains a function <code>ascii_stats</code> that calculates the percentages of strings containing or not containing special (non-ASCII) characters.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">kwb.fakin<span class="op">:::</span><span class="kw">ascii_stats</span>(paths)</a></code></pre></div>
<pre><code>## nonAscii
##    FALSE     TRUE 
## 88.88889 11.11111</code></pre>
<p>The aim should be to reduce the percentage of non-ASCI characters.</p>
</div>
<div id="quality-of-folder-structures" class="section level2">
<h2 class="hasAnchor">
<a href="#quality-of-folder-structures" class="anchor"></a>Quality of Folder Structures</h2>
<p>If we modify folder structures in order to make them more intuitive we need a tool to measure the improvement. Therefore I created an account on the following website:</p>
<p><a href="https://www.optimalworkshop.com/treejack" class="uri">https://www.optimalworkshop.com/treejack</a></p>
<p>There, you can define tree structures of which interactive web-pages are created where users are asked to navigate to a certain file in the tree. Behind the scenes the web page tracks the clicks of the user on his way through the tree. The treejack service provides an import functionality where you can define the structure of the tree by giving a set of text lines with each line representing a branch or a leaf of the tree.</p>
<p>The function <code>subtree_for_treejack</code> creates the text that is required here:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">kwb.fakin<span class="op">:::</span><span class="kw">subtree_for_treejack</span>(<span class="dt">root =</span> <span class="st">"project-1"</span>, paths)</a></code></pre></div>
<pre><code>## Filter for paths starting with project-1/ ...
##   ok. Remaining paths: 5 
## Convert to relative paths ... ok.
## Splitting paths ... ok. (0.00s) 
## Splitting paths ... ok. (0.00s) 
## Splitting paths ... ok. (0.00s) 
## Splitting paths ... ok. (0.00s) 
## Splitting paths ... ok. (0.00s) 
## 
## ================================================================
## 
## Copy and paste the output below to the 'Bulk import' input field
## at https://www.optimalworkshop.com
## 
## ================================================================
## 
## wp 2 
##  input
##  output
## wp-1 
##  analysis
##  input</code></pre>
</div>
<div id="analysis-of-paths" class="section level2">
<h2 class="hasAnchor">
<a href="#analysis-of-paths" class="anchor"></a>Analysis of Paths</h2>
<p>We can split the paths into their parts using the <code>split_paths</code> function from the kwb.file package:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1">parts &lt;-<span class="st"> </span>kwb.file<span class="op">::</span><span class="kw">split_paths</span>(paths)</a></code></pre></div>
<pre><code>## Splitting paths ... ok. (0.00s)</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1">parts[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</a></code></pre></div>
<pre><code>## [[1]]
## [1] "project-1"  "wp-1"       "input"      "file 1.csv"
## 
## [[2]]
## [1] "project-1"  "wp-1"       "input"      "file-2.csv"
## 
## [[3]]
## [1] "project-1"   "wp-1"        "analysis"    "summary.pdf"</code></pre>
<p>It may be useful to convert the list that is returned by <code>split_paths</code> into a matrix:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">subdirs &lt;-<span class="st"> </span>kwb.fakin<span class="op">:::</span><span class="kw"><a href="../reference/toSubdirMatrix.html">toSubdirMatrix</a></span>(parts)</a></code></pre></div>
<table class="table">
<caption>Content of the subdirs matrix</caption>
<tbody>
<tr class="odd">
<td align="left">project-1</td>
<td align="left">wp-1</td>
<td align="left">input</td>
<td align="left">file 1.csv</td>
</tr>
<tr class="even">
<td align="left">project-1</td>
<td align="left">wp-1</td>
<td align="left">input</td>
<td align="left">file-2.csv</td>
</tr>
<tr class="odd">
<td align="left">project-1</td>
<td align="left">wp-1</td>
<td align="left">analysis</td>
<td align="left">summary.pdf</td>
</tr>
<tr class="even">
<td align="left">project-1</td>
<td align="left">wp 2</td>
<td align="left">input</td>
<td align="left">köpenick_dirty.csv</td>
</tr>
<tr class="odd">
<td align="left">project-1</td>
<td align="left">wp 2</td>
<td align="left">output</td>
<td align="left">koepenick_clean.csv</td>
</tr>
<tr class="even">
<td align="left">project-2</td>
<td align="left">Daten</td>
<td align="left">file-1.csv</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">project-2</td>
<td align="left">Grafiken</td>
<td align="left">file 1.png</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">project-2</td>
<td align="left">Berichte</td>
<td align="left">bericht-1.doc</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">project-2</td>
<td align="left">Berichte</td>
<td align="left">bericht-2.doc</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>In the matrix, each row represents a path and each column represents a depth level.</p>
<p>If you have only one path, you may create the paths to all direct parent directories using the function <code>all_path_levels</code>. This is how <code>subtree_for_treejack</code> creates the text for the bulk import to Treejack (see above).</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1">(parent_paths &lt;-<span class="st"> </span>kwb.fakin<span class="op">:::</span><span class="kw"><a href="../reference/all_path_levels.html">all_path_levels</a></span>(paths[<span class="dv">1</span>]))</a></code></pre></div>
<pre><code>## Splitting paths ... ok. (0.00s)</code></pre>
<pre><code>## [1] "project-1"                       "project-1/wp-1"                 
## [3] "project-1/wp-1/input"            "project-1/wp-1/input/file 1.csv"</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1">parents &lt;-<span class="st"> </span>kwb.fakin<span class="op">:::</span><span class="kw"><a href="../reference/toSubdirMatrix.html">toSubdirMatrix</a></span>(parent_paths)</a></code></pre></div>
<pre><code>## Splitting paths ... ok. (0.00s)</code></pre>
<table class="table">
<caption>Content of the parents matrix</caption>
<tbody>
<tr class="odd">
<td align="left">project-1</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td align="left">project-1</td>
<td>wp-1</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td align="left">project-1</td>
<td>wp-1</td>
<td>input</td>
<td></td>
</tr>
<tr class="even">
<td align="left">project-1</td>
<td>wp-1</td>
<td>input</td>
<td>file 1.csv</td>
</tr>
</tbody>
</table>
</div>
<div id="importance-of-directories" class="section level2">
<h2 class="hasAnchor">
<a href="#importance-of-directories" class="anchor"></a>Importance of Directories</h2>
<p>In order to find the most important folder paths in terms of frequency and length you may use the function <code>sortedImportance</code>:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">kwb.fakin<span class="op">:::</span><span class="kw"><a href="../reference/sortedImportance.html">sortedImportance</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/basename">dirname</a></span>(paths))</a></code></pre></div>
<pre><code>## x
##    project-1/wp-1/input      project-2/Berichte project-1/wp-1/analysis 
##                      40                      36                      23 
##   project-1/wp 2/output    project-1/wp 2/input      project-2/Grafiken 
##                      21                      20                      18 
##         project-2/Daten 
##                      15</code></pre>
</div>
<div id="compression-of-folder-paths" class="section level2">
<h2 class="hasAnchor">
<a href="#compression-of-folder-paths" class="anchor"></a>Compression of Folder Paths</h2>
<p>Assume you have a folder with a long path (either due to a lot of levels or due to long folder names). This long path is repeated for each file in the folder. The package provides a <code>compress</code> function that may be used to introduce short names for directory paths.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1">directories &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"short"</span>, <span class="st">"short"</span>, <span class="st">"short"</span>, <span class="st">"longer/path"</span>, <span class="st">"longer/path"</span>)</a>
<a class="sourceLine" id="cb50-2" data-line-number="2"></a>
<a class="sourceLine" id="cb50-3" data-line-number="3">short_dirs &lt;-<span class="st"> </span>kwb.fakin<span class="op">:::</span><span class="kw">compress</span>(directories)</a>
<a class="sourceLine" id="cb50-4" data-line-number="4"></a>
<a class="sourceLine" id="cb50-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/character">as.character</a></span>(short_dirs)</a></code></pre></div>
<pre><code>## [1] "&lt;a2&gt;" "&lt;a2&gt;" "&lt;a2&gt;" "&lt;a1&gt;" "&lt;a1&gt;"</code></pre>
<p>The function returns the lookup table (dictionary) that maps short names to long names in the attribute <code>dict</code>:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">(dictionary &lt;-<span class="st"> </span>kwb.utils<span class="op">::</span><span class="kw">getAttribute</span>(short_dirs, <span class="st">"dict"</span>))</a>
<a class="sourceLine" id="cb52-2" data-line-number="2">## $a1</a>
<a class="sourceLine" id="cb52-3" data-line-number="3">## [1] "longer/path"</a>
<a class="sourceLine" id="cb52-4" data-line-number="4">## </a>
<a class="sourceLine" id="cb52-5" data-line-number="5">## $a2</a>
<a class="sourceLine" id="cb52-6" data-line-number="6">## [1] "short"</a></code></pre></div>
<p>The dictionary is sorted by the importance of the strings (paths) that have been given to <code>compress</code> so that the most important paths get the highest positions in the dictionary. With importance we mean the product of the length of a string (path) and its number of occurrences.</p>
<p>The dictionary is required to convert the short names back to the original paths using the <code>resolve</code> function of the <code>kwb.utils</code> package:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1">(long_dirs &lt;-<span class="st"> </span>kwb.utils<span class="op">::</span><span class="kw">resolve</span>(short_dirs, dictionary))</a>
<a class="sourceLine" id="cb53-2" data-line-number="2">## [1] "short"       "short"       "short"       "longer/path" "longer/path"</a>
<a class="sourceLine" id="cb53-3" data-line-number="3"></a>
<a class="sourceLine" id="cb53-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/identical">identical</a></span>(long_dirs, directories)</a>
<a class="sourceLine" id="cb53-5" data-line-number="5">## [1] TRUE</a></code></pre></div>
<p>There is another function <code>compressOneByOne</code>, what does it do?</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/attributes">attributes</a></span>(kwb.fakin<span class="op">:::</span><span class="kw">compressOneByOne</span>(paths, <span class="dt">n =</span> <span class="dv">3</span>))</a></code></pre></div>
<pre><code>## Splitting paths ... ok. (0.00s) 
## Elapsed: 0.0 s
## Splitting paths ... ok. (0.00s) 
## Elapsed: 0.0 s
## Splitting paths ... ok. (0.00s) 
## Elapsed: 0.0 s</code></pre>
<pre><code>## NULL</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#providing-file-path-information">Providing File Path Information</a></li>
      <li><a href="#plotting-paths">Plotting Paths</a></li>
      <li><a href="#treemaps">Treemaps</a></li>
      <li><a href="#selecting-paths">Selecting Paths</a></li>
      <li><a href="#quality-of-file-and-folder-names">Quality of File and Folder Names</a></li>
      <li><a href="#quality-of-folder-structures">Quality of Folder Structures</a></li>
      <li><a href="#analysis-of-paths">Analysis of Paths</a></li>
      <li><a href="#importance-of-directories">Importance of Directories</a></li>
      <li><a href="#compression-of-folder-paths">Compression of Folder Paths</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Hauke Sonnenberg.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'c90392a3aed8c0b61fa47cde2c49d8d5',
    indexName: 'kwb_fakin',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
